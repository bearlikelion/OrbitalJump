[gd_scene load_steps=2 format=2]

[sub_resource type="GDScript" id=1]
script/source = "extends Node2D

var Circle = preload(\"res://src/Objects/Circle.tscn\")
var Jumper = preload(\"res://src/Objects/Jumper.tscn\")

var player

func _ready():
	randomize()
	new_game()
	
func new_game():
	$Camera2D.position = $StartPosition.position
	player = Jumper.instance()
	player.position = $StartPosition.position
	add_child(player)
	player.connect(\"landed\", self, \"_on_Jumper_landed\")
	spawn_circle($StartPosition.position)
	
func spawn_circle(_position=null):	
	var c = Circle.instance()	
	# TODO: Better random range
	if !_position:
		var x = rand_range(-150, 150)
		var y = rand_range(-500, -400)
		_position = player.target.position + Vector2(x, y)		
	add_child(c)
	c.init(_position)

func _on_Jumper_landed(object):	
	$Camera2D.position = object.position
	call_deferred(\"spawn_circle\")
"

[node name="Main" type="Node2D"]
script = SubResource( 1 )

[node name="StartPosition" type="Position2D" parent="."]
position = Vector2( 224, 704 )

[node name="Camera2D" type="Camera2D" parent="."]
offset = Vector2( 0, -200 )
current = true
smoothing_enabled = true
smoothing_speed = 10.0
